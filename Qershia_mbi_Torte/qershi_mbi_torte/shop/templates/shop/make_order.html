{% extends "shop/navbar_footer.html" %}
{% load static %}

{% block content %}
<div style="max-width: 700px; margin: 50px auto; background: rgba(255,255,255,0.95); padding: 30px; border-radius: 10px;">
    <h1 style="color:#d32f2f; text-align:center; margin-bottom:20px;">Your Order</h1>

    {% if request.session.cart %}
        <table style="width:100%; border-collapse: collapse;">
            <thead>
                <tr>
                    <th style="text-align:left; border-bottom:1px solid #ccc; padding:10px;">Product</th>
                    <th style="text-align:center; border-bottom:1px solid #ccc; padding:10px;">Quantity</th>
                    <th style="text-align:right; border-bottom:1px solid #ccc; padding:10px;">Price</th>
                    <th style="text-align:right; border-bottom:1px solid #ccc; padding:10px;">Total</th>
                </tr>
            </thead>
            <tbody>
                {% for product_id, item in request.session.cart.items %}
                    <tr>
                        <td style="padding:10px;">{{ item.name }}</td>
                        <td style="text-align:center;">{{ item.quantity }}</td>
                        <td style="text-align:right;">{{ item.price }}€</td>
                        <td style="text-align:right;">{{ item.quantity|multiply:item.price }}€</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>

        {% comment %}
        Llogarit totalin e porosisë
        {% endcomment %}
        {% with total=0 %}
            {% for product_id, item in request.session.cart.items %}
                {% with line_total=item.quantity|multiply:item.price %}
                    {% with total=total|add:line_total %}
                    {% endwith %}
                {% endwith %}
            {% endfor %}
            <p style="text-align:right; font-weight:bold; margin-top:20px;">Total: {{ total }}€</p>
        {% endwith %}

        <form action="{% url 'create_order_from_cart' %}" method="post" style="text-align:center; margin-top:30px;">
            {% csrf_token %}
            <button type="submit" style="padding:15px 30px; background:#d32f2f; color:white; border:none; border-radius:8px; font-size:16px;">
                Confirm Order
            </button>
        </form>
    {% else %}
        <p style="text-align:center; color:#888; font-size:1.2em;">
            Shporta juaj është bosh. <br>
            <a href="{% url 'products' %}">Shko tek produktet</a> për të blerë.
        </p>
    {% endif %}
</div>
{% endblock %}
